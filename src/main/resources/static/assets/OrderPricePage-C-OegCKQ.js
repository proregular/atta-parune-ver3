import{c as l,R as c,b as k,aJ as A,aI as D,u as S,w as B,af as M,j as e,x as T,aL as P,p as f,q as R}from"./index-C7S2opxg.js";const E=()=>{const[o,g]=l.useState({}),[d,j]=l.useState({}),[r,w]=l.useState(0);c(k);const[i,x]=c(A),[n,y]=c(D),u=S(),b=sessionStorage.getItem("userId"),p=B(),{id:m}=M();l.useEffect(()=>{(async()=>{try{const t=await f.get("/api/user/activeOrderCheck",{headers:{Authorization:`Bearer ${p}`}});console.log(t.data.resultData);const a=t.data.resultData.totalMenuCost;w(a)}catch(t){console.log(t)}})()},[]);const N=async()=>{const s={...i,orderId:m};console.log(s);try{const t=await f.post("/api/user/user-payment-member",s,{headers:{Authorization:`Bearer ${p}`}});console.log(t.data.resultData),t.data.resultData>=0?(console.log("결제 승인 요청을 보냈습니다"),u(`/user/placetoorder/request/${m}`,{state:{restaurantId:r==null?void 0:r.restaurantId}})):console.log("요청에 실패했습니다. 다시 시도해주세요")}catch(t){console.log(t)}},I=({target:{value:s}},t)=>{console.log(s),g(a=>({...a,[t]:s}))},v=s=>{j(a=>({...a,[s]:!a[s]}));const t=parseInt(o[s],10)||0;x(a=>({...a,data:[...a.data.filter(C=>C.userId!==s),{userId:s,point:t}]}))},h=()=>{R.fire({icon:"warning",title:"다시 시작하시겠습니까?",text:"확인을 누를 시, 인원 선택을 다시 해야합니다",showCancelButton:!0,confirmButtonText:"확인",cancelButtonText:"취소"}).then(s=>{s.isConfirmed&&(x(t=>({...t,point:[],userId:[parseInt(b)]})),y([]),u(-1))})};return console.log("화면에 출력할 데이터 : ",n),console.log("서버에 보낼 데이터 : ",i),e.jsxs("div",{className:"w-full h-dvh overflow-x-hidden overflow-y-scroll scrollbar-hide",children:[e.jsxs("div",{className:"flex w-full justify-between py-6 items-center border-b border-gray",children:[e.jsx("div",{className:"flex w-[15%] justify-center",children:e.jsx(T,{className:"text-3xl",onClick:()=>h()})}),e.jsx("span",{className:"text-lg font-semibold",children:"금액 선택"}),e.jsx("div",{className:"w-[15%]",children:e.jsx("span",{className:"text-center px-3 py-1 rounded-md text-white text-opacity-0",children:" "})})]}),e.jsxs("div",{className:"flex flex-col w-full h-full gap-6",children:[e.jsxs("div",{className:"flex w-full justify-center gap-2 pt-4 text-xl",children:[e.jsx("span",{children:"총 결제 금액 : "}),e.jsxs("span",{className:`text-end px-2 ${Math.sign(parseInt(r))===-1?"text-red":"text-black"}`,children:[r==null?void 0:r.toLocaleString("ko-KR"),"원"]})]}),Array.isArray(n)&&(n==null?void 0:n.map(s=>{var t;return e.jsxs("div",{className:"flex w-full h-[6%] px-6 justify-between items-center border-b border-gray",children:[e.jsxs("span",{className:"flex w-[40%] text-base text-nowrap",children:[s.name,"(",s.uid,")"]}),e.jsx("div",{className:"flex w-[35%] gap-2 items-center justify-end",children:d[s.userId]?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-end px-2",children:(t=o[s.userId])==null?void 0:t.toLocaleString("ko-KR")}),e.jsx("span",{children:"원"})]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"tel",className:"flex w-[70%] border border-darkGray px-2 text-end rounded-md",onChange:a=>I(a,s.userId),value:o[s.userId]||""}),e.jsx("span",{children:"원"})]})}),e.jsx("div",{className:"flex w-[15%] justify-center gap-2 text-nowrap items-center",children:e.jsx("span",{onClick:()=>v(s.userId),className:"bg-blue px-2 text-white font-medium rounded-md cursor-pointer",children:d[s.userId]?"수정":"확인"})})]},s.userId)})),e.jsx("div",{className:"flex w-full h-[5%] justify-center items-center",children:e.jsx(P,{onClick:h,className:"text-3xl"})}),e.jsx("div",{className:"flex w-full justify-center",children:e.jsx("span",{onClick:()=>N(),className:"bg-primary text-white text-lg px-2 py-1 rounded-md",children:"승인 요청"})})]})]})};export{E as default};
